
@{
    ViewBag.Title = "borrowed_items_by_order";
    Layout = "~/Views/Shared/_DashboardLayout.cshtml";
}

<section class="content-header">
    <h1>
        Dashboard
        <small>Items Borrowed</small>
    </h1>
    <ol class="breadcrumb">
        <li><a href="/estore/dashboard"><i class="fa fa-dashboard"></i>Dashboard</a></li>
        <li class="active">Items Borrowed</li>
    </ol>
</section>

<section ng-controller="borrowRequestController" class="content">
    <div class="panel panel-default">
        <div class="panel-body">
            <div class="col-md-9">
                <div class="box box-success">
                    <div class="box-header with-border">
                        <h3 class="box-title">Items Borrowed</h3>

                        <div class="box-tools pull-right">
                            <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                            @*<button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-remove"></i></button>*@
                        </div>
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body">
                        <div class="row">
                            <div class="col-md-12 table-responsive">
                                <table st-table="sModel" st-safe-src="Model" class="table table-bordered table-striped" style="text-transform:capitalize">
                                    <thead>
                                        <tr>
                                            <th colspan="4" style="text-align:center; color:red;font-size:x-large">Items Borrowed by '{{sModel[0].department}}{{sModel[0].state_office}}{{sModel[0].regional_office}}' <i class="glyphicon glyphicon-shopping-cart"></i>
                                                <br />
                                                {{sModel[0].unit}}    
                                            <br />
                                                <span class="text-success">Store Requisition No: {{sModel[0].s_R_V_No}}</span>
                                            </th>
                                            <th colspan="2">
                                                <input st-search="" class="form-control" placeholder="search ..." type="text" />
                                            </th>
                                        </tr>
                                        <tr>
                                            <th>SRV</th>
                                            <th>
                                                Item Name
                                            </th>
                                            <th>
                                                Qty. Requested
                                            </th>
                                            <th style="text-wrap:normal">
                                                Qty. Requested <br /><span class="text-danger">(in base unit)</span>
                                            </th>
                                            <th style="text-wrap:normal">
                                                Qty. Allocated <br /> <span class="text-danger">(in base unit)</span>
                                            </th>
                                            <th><button class="btn btn-danger" title="delete" ng-click="deleteAllBorrowbyOrder(sModel[0].r_order_no)"> Delete All <i class="glyphicon glyphicon-trash"></i></button></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr ng-repeat="c in sModel">
                                            <td>
                                                {{c.s_R_V_No}}
                                            </td>
                                            <td>
                                                {{c.product_name}}
                                            </td>
                                            <td>
                                                {{c.requested_qty_unit_value|number}} {{c.requested_qty_unit|lowercase}}
                                            </td>
                                            <td class="text-danger text-bold">
                                                {{c.qty_requested|number}} {{c.item_base_unit|lowercase}}
                                            </td>
                                            <td class="text-success text-bold">
                                                {{c.qty_allocated|number}} {{c.item_base_unit|lowercase}}

                                            </td>
                                            <td>
                                                <button class="btn btn-warning" title="edit" ng-click="editAllocation(c.r_id)"><i class="glyphicon glyphicon-edit"></i></button>
                                                <button class="btn btn-danger" title="delete" ng-click="deleteAllocation(c.r_id)"><i class="glyphicon glyphicon-trash"></i></button>
                                            </td>
                                        </tr>
                                    </tbody>
                                    <tfoot>
                                        <tr>
                                            <td colspan="6" class="text-center">
                                                <div st-pagination="" st-items-by-page="itemsByPage" st-template="Template/pagination-custom.html"></div>
                                            </td>
                                        </tr>
                                    </tfoot>
                                </table>
                                @*<form name="approvalForm" ng-submit="approve_request()" novalidate>
                                        <div class="form-group  has-feedback">
                                            <label class="control-label">Approver: <span class="text-danger">*</span></label>
                                            <select id="ddlApprover" class="form-control" ng-model="ddlApprover" required name="ddlApprover">
                                                <option selected="selected" value="">Select Name</option>
                                                <option ng-repeat="s in Users|orderBy:'id'" value="{{s.id}}">{{s.name}}</option>
                                            </select>
                                            <span class="text-danger" ng-show="approvalForm.ddlApprover.$invalid">required!</span>
                                        </div>
                                        <span ng-model="orderid"></span>
                                    </form>*@
                                <button ng-click="markAsFreshRq(sModel[0].r_order_no)" class="btn btn-success" title="process as request">Process as Fresh Request <i class="glyphicon glyphicon-ok"></i></button>
                                <button class="btn btn-danger pull-right" onclick="history.go(-1);"><i class="glyphicon glyphicon-chevron-left"> </i>Go Back</button>
                            </div>
                        </div>                        <!-- /.row -->
                    </div>        <!-- /.box-body -->
                    <div class="box-footer">

                    </div>
                </div>

            </div>
            <div ng-show="showUpallct" class="col-md-3">
                <div class="box box-info">
                    <div class="box-header with-border">
                        <h3 class="box-title">Update Qty allocated</h3> <br />
                        <div class="box-tools pull-right">
                            <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i></button>
                            @*<button type="button" class="btn btn-box-tool" data-widget="remove"><i class="fa fa-remove"></i></button>*@
                        </div>
                    </div>
                    <!-- /.box-header -->
                    <div class="box-body">
                        <div class="panel panel-default">
                            <div class="panel-body">
                                <form name="updateAllct" novalidate ng-submit="updateAllocation()">
                                    <!-- /.col -->
                                    <span ng-model="id"></span>
                                    <span ng-model="item_id"></span>

                                    <div class="form-group">
                                        <label class="control-label">Qty. Allocated <span class="text-danger">*</span></label>
                                        <input type="number" required class="form-control" placeholder="Quantity allocated" name="qty_allct" ng-model="qty_allct" min="0" />
                                        <span class="text-danger" ng-show="updateAllct.qty_allct.$invalid">required!</span><br />
                                    </div>
                                    <div class="row">
                                        <div class="col-xs-10">
                                            <button class="btn btn-success btn-block btn-flat" type="submit" ng-disabled="updateAllct.qty_allct.$invalid">
                                                Update Allocation&nbsp;&nbsp; <i class="glyphicon glyphicon-upload"></i>
                                            </button>
                                        </div>
                                    </div>
                                </form>
                            </div>

                        </div>
                        <!-- /.row -->
                    </div>
                    <!-- /.box-body -->
                    <div class="box-footer">
                        <b>All fields mark with (<span style="color:red">*</span>), are required!</b>
                    </div>
                </div>
            </div>

        </div>
    </div>

</section>

@section scripts{
    <script src="~/Scripts/sweetalert.min.js"></script>
    <script src="~/Scripts/bootstrap-datepicker.js"></script>   
    <script>
        $(".select2").select2();
        $('.datepicker').datepicker({
            autoclose: true,
            todayHighlight: true
        });
    </script>
    <script src="~/Angular/Controllers/borrowRequestController.js"></script>
    <script src="~/Angular/pageSelectDirective.js"></script>
    <script src="~/Angular/state.js"></script>
}




